2.2 Mobil Uygulama Tanıtımı
Bu bölümde neworld uygulamasına mobil uygulama tanıtılacaktır.  Web sitesinin fonksiyonları görseller ile açıklanacaktır. 
Giriş yaptığımızda karşımızda bizi aşağıdaki gibi bir ekran karşılar. Bu ekranda kullanıcıdan beklediğimiz aksiyon siteye giriş yapmasıdır. Bunu yapabilmek için Google veya Facebook seçeneklerini kullanabilir. Kullanıcı ilk defa bunu yaptığında sisteme üye olur, sonrasında aynı şekilde giriş yapar.

figür 16: mobil uygulama giriş sayfası
Kullanıcı giriş yaptıktan sonra uygulamanın bir çok özelliği kullanıcıya görünür olur ve kullanıcı aşağıdaki gibi bir sayfa ile karşılaşır. 
Kullanıcıya Blog, Vakıflar, Karbon Ayak izi hesaplama, Profil sayfası, Keşfet ekranları gibi özellikler sunulur. Sırayla Bu sayfalar ve fonksiyonları açıklanacaktır.

Home
Giriş yapıldığında açılan sayfa aşağıdaki, Profil bilgilerinin ve arkadaşların gösterildiği Home sayfasıdır. Kullanıcı bu sayfada profil bilgilerini görüntüleyebilir, bio düzenleyebilir, arkadaş ekleyebilir, lider tablosunu görebilir, çıkış yapabilir ve diğer bölümlere geçiş yapabilir.

figür 17: mobil uygulama anasayfa
Karbon Ayak İzi
Bu sayfada kullanıcı, karbon ayak izini hesaplayabilir. Karbon ayak izinin hesaplanabilmesi için uçak, araba, otobüs, motosiklet, elektrik, doğalgaz için veri girişi yapmaya yönlendiren butonlar bulunmaktadır. Kullanıcı ilgili bilgileri alanlara girerek karbon ayak izini hesaplatabilir.

figür 18: mobil uygulama geri dönüşüm noktaları yol tarifi

Geri Dönüşüm Noktaları
Bu sayfada kullanıcı Ankara içerisindeki geri dönüşüm noktalarını görüp istediği noktaya yol tarifi alabilmektedir. Kullanıcı haritalara ilk giriş yaptığında mevcut konumuna en yakın geri dönüşüm noktasına otomatik olarak yol tarifi oluşturur. Kullanıcı harita üzerindeki diğer geri dönüşüm noktalarını seçerek yol tarifini güncelleyebilir. Kullanıcı seçilen geri dönüşüm noktasına vardığında kullanıcının skoru güncellenir.

figür 19: mobil uygulama karbon ayakizi hesaplama

Dashboard
Kullanıcı bu ekranda, vakıf bültenlerini, kullanıcı blog yazılarını ve kullanıcıları görebilir, arama yerini kullanarak bu verileri istediği şekilde filtreleyebilir.

figür 20: mobil uygulama keşfet sayfası

Blog
Kullanıcı Blog ekranında, kendi blog gönderilerini görüntüleyebilir, yeni gönderiler yapabilir. 

figür 21: mobil uygulama blog sayfası
Foundations
Kullanıcı Foundations ekranında Tema ve GreenPeace ile ilgili kısa bir tanıtımla karşılaşır. Üzerlerine tıklandığında ise aşağıdaki şekilde vakıf bültenlerini görebileceği ve bağış yapabileceği bir ekrana yönlendirilir.

figür 22: mobil uygulama vakıflar sayfası
Vakıf bültenlerini görebileceği ve bağış yapabileceği ekranlar aşağıdaki gibidir.




figür 23: örnek vakıf sayfası

Skor Tablosu
Kullanıcıların karbon ayak izi değerlerine göre sıralaması buradan görüntülenir.


figür 24: mobil lider tablosu
2.3 Unity Tanıtımı
Bu kısımda neWorld projesi kapsamında Unity üzerinden gerçekleştirdiğimiz projenin fonksiyonları tanıtılacaktır. Unity kısmında kullanıcının karbon ayak izine göre kendi dünyasında çeşitli ağaçlar ekleyebilmesi, karbon ayakizi düştükçe ödüllendirilmesi ve arkadaşlarının dünyasını ziyaret edebilmesi amaçlanmıştır.


Figür 25: Giriş ekranı
Kullanıcı oyunu başlattığında ilk olarak giriş ekranıyla karşılaşmaktadır. Bu ekranda giriş yapıldıktan sonra kullanıcının karbon ayak izi kullanıcıya aktarılmaktadır. 

Figür 26: Karbon ayakizi

Kullanıcı tamam butonuna tıkladıktan sonra artık dünyasını görebilir.


Figür 27: Kullanıcı dünyası

Bu dünya üzerinde kullanıcı çeşitli ağaç eklemeleri yapabilmekte ve dolaşabilmektedir. Sol altta bulunan ağaç listesi kullanıcının dünyasına ekleyebileceği ağaçlardan oluşmaktadır. Karbon ayakizine göre bu kısımdan seçebileceği ağaçlar kısıtlanmaktadır. Kullanıcı belirli bir karbon ayakizi seviyesinin altına düştüğü zaman, sıralı bir şekilde, kullanabileceği ağaçlar açılmaktadır. Sol yukarıda bulunan arkadaşlar butonuna tıklanıldığında kullanıcının arkadaşları listelenmektedir.


Figür 28: Arkadaş listesi

Bu panel üzerinde kullanıcı istediği arkadaşı seçerek arkadaşının dünyasını görüntüleyebilmektedir. 

Figür 29: Arkadaş dünyası
Arkadaş dünyası ziyaret edildiğinde dünyayı kaydetme ve ağaç ekleme panelleri kapanmaktadır. Ek olarak kullanıcının kendi dünyasına dönmesini sağlayan bir buton belirmektedir.
Figür 30: Google gaming solution butonu
Sol üst tarafta bulunan World butonuna tıklandığında kullanıcının karbon ayakizine göre bina assetleri oluşturulmuş dünyaya gidilmektedir.

Figür 31: Googlemaps dünya görünümü
Bu dünya Google Maps Gaming Solution ile oluşturulmuştur. Kullanıcının karbon ayak izine göre güncellenmektedir.
 Sistem Mimarisi 

Figür 32: Proje Modülleri
Mimari Bileşenlerinin Etkileşimleri
Actions ve Events Diyagramı ve Tablosu

Figür 33: Proje event - action tablosu




Events
Actions
Event  1
Kullanıcı karbon parametreleri girişi
Action 1
Karbon ayak izi hesaplanması
Event 2
Kullanıcı karbon ayak izi değişimini görmek isterse
Action 2 
Belirli zaman dilimine ait verilerin grafikle gösterilmesi
Event 3
Kullanıcının bir dünyayı görüntülemesi
Action 3a
Databaseden dünya verilerini al dünyayı oluştur
Action 3b
Kullanıcıya göster
Event 4
Karbon ayak izinde değişiklik olması
Action 4
Kullanıcı karbon ayak izi değişimi ile dünya güncellenmesi
Event 5
Kullanıcının dünyaya ekleme yapması
Action 5
Oyun içi asset ekleme ve kaydetme 
Event 6
Kullanıcı profil sayfasında değişiklikler yapar
Action 6
Değişiklikler databasede güncellenir
Event 7
Kullanıcı Sayfasından blog yazısı ekler


Action 7a
Blog yazısı sayfaya eklenir
Action 7b
Blog yazısı database e eklenir
Event 8


Kullanıcının bağış yapması


Action 8
Kullanıcının karbon ayak izinin azaltılması. Bağışın vakfa uygulama tarafından gönderildiği varsayılmaktadır.
Event 9
Kullanıcının Vakıf Bültenlerine ulaşması
Action 9
Bültenler databaseden çekilir
Event 10
Kullanıcı vakfın güncel haberlerine ulaşmak ister
Action 10
Günlük olarak vakfın sitesinden haberler çekilip database güncellenir.
Event 11
Vakıf bültenleri ve kullanıcı blog yazılarının gösterilmesi
Action 11
DB’ den vakıf bültenleri ve kullanıcı blog yazılarının keşfet modülüne çekilmesi. Keşfet modülü tarafından verilerin android/ web uygulaması üzerinde gösterilmesi 
Event 12
Arama butonuna kişi bilgileri yazılarak tıklanması
Action 12
Kullanıcının girdiği bilgilere göre arama için sorgulama yapılarak sonuçların gösterilmesi
Event 13
Kullanıcının bir yazı ile keşfet üzerinde arama yapması


Action 13
Aranılan yazıyı barındıran, kullanıcı blog yazılarının ve vakıf bültenlerinin databaseden çekilip kullanıcıya gösterilmesi
Event 14
Lider tablosu sekmesine gidilmesi


Action 14
Veritabanı kullanıcılar tablosundan kullanıcı bilgilerinin modüle aktarılması, kullanıcıların puana göre sıralanması ve kullanıcıya gösterilmesi
Event 15
Kullanıcı geri dönüşüm noktasını arar.
Action 15
Kullanıcıya yakın geri dönüşüm noktaları gösterilir.
Event 16
Kullanıcı istediği geri dönüşüm noktasını seçer
Action 16
Kullanıcının seçtiği geri dönüşüm kutusuna yol tarifi gösterilir.
Event 17
Kullanıcı en yakın geri dönüşüm noktasına ulaşır
Action 17
Kullanıcının karbon ayak izi database üzerinde azalır


Herbir Sistem Parçasının Detaylı Açıklanması
Bu mimaride uygulama aşamasını daha da detaylı göstermek için, proje incelendikten sonra, projeyi temel parçalarını göz önünde bulundurarak parçalara böldük. Bu parçalar aşağıdaki diyagramda görüldüğü gibidir.

Figür 34: Sistem modülleri
Oyun Modülü
Unity üzerinde kullanıcıların dünyalarının kaydedilmesini sağlayan akış diyagramı aşağıdaki şemada gösterilmiştir. SaveLoad objesi GridSystem objesinin kaydet fonksiyonunu kullanır. GridSystem objesi üzerinde bulunan ağaç objelerinin tiplerini ve konumlarını belirli bir format ile firebase veritabanına aktarır.


figür 35: oyun kaydetme akış diyagramı

Kullanıcıların arkadaş listesini ve arkadaşlarının dünyalarını görüntülemelerini sağlayan akış diyagramı aşağıdaki gibidir. İlk aşamada kullanıcıların arkadaşları veritabanından okunur ve butonlar halinde bir panel oluşturulur. Butonlardan birine tıklanıldığı zaman GridSystem üzerinde Load fonksiyonu çağırılır ve bu metot içerisinde ziyaret edilecek kullanıcının dünya bilgileri veritabanından okunduktan sonra dünya güncellenir. Güncellemeden sonra, kullanıcının ziyaret ettiği dünyayı değiştirmemesi için, ekleme yapma özellikleri kaldırılır. Bu kaldırma işlemi MainMenu üzerindeki FriendButtonClicked() fonksiyonu ile sağlanır.




figür 36: arkadaş dünyası görüntüleme akış diyagramı

Kullanıcının giriş yapması ve dünyasını görüntülemesini sağlayan fonksiyonların ve objelerin akış diyagramı aşağıdaki gibidir. GameManager objesi tarafından kişinin emaili ve şifresi alınır. Alınan veriler veritabanı üzerinde sorgulanır. Score() metodu ile kullanıcının veritabanından alınan karbon ayakizi kullanıcıya aktarılır. Kullanıcının giriş maili GameHandler objesinde tutulmaktadır.
 Dünya güncellemesi yapılabilmesi için GameHandler objesinden bu veri alınır ve GridSystem üzerindeki Load fonksiyonuna gönderilir. Load() fonksiyonu ise kendi içerisinde Plant() fonksiyonlarını çağırarak ağaç objelerini uygun konumlarda oluşturur.

figür 37: uygulamaya giriş akış diyagramı

Ayrıca gerçekçi bir dünya görüntüsü için Google Maps Gaming Solution kullanılarak görsellik sağlanmıştır. Oyundaki yapıların Texture’ı karbon ayak izine göre değiştirilmekte, tarzı yenilenmektedir. Yenileme yapısı aşağıdaki diagramda gösterilmiştir.

figür 38: Texture değiştirme akış diyagramı

Karbon Ayak İzi Modülü
Web tarafında karbon ayakizi hesaplama ve grafik olarak kullanıcıya aktarmak için gerçekleştirilen eylemlerin akış şeması aşağıda verilmiştir. CarbonFootPrint controller RequestMapping(“carbonFootprint”) ile kullanıcıyı karbon ayakizinin hesaplanacağı ve gösterileceği sayfaya yönlendirir.  Bu sayfa üzerinde Firebase veritabanına bağlantı kurulur ve kullanıcının karbon ayakizi bilgileri alınarak kullanıcıya aktarılır. 
Kullanıcı yeni karbon ayakizi değerlerini hesaplamak isterse useAPIs() fonksiyonu ile rapidapi üzerinden karbon ayakizi hesaplama API’ ına request göndererek kullanıcının taşıma yöntemlerine göre karbon ayakizini hesaplar. Hesaplanan yeni verileri veritabanı üzerinde güncelledikten sonra yazı ve grafik ile kullanıcıya gösterir. 

figür 39: web uygulaması karbon ayakizi hesaplama ve gösterme akış diyagramı

Kullanıcı Sayfaları ve Bilgileri Modülü
Kullanıcı Profil Sayfası :

figür 40: profil görüntüleme akış diyagramı
Kullanıcı web uygulamasına giriş yaptığında kendine ait profili görüntüleyebilmesi gerekmektedir. Bunun için birkaç gereksinim mevcuttur.
Uygulamaya giriş yapmış kullanıcıya authentication doğrulaması yapılması.
Kullanıcıya ait isim, mail gibi bilgilerin authentication ile kontrol edilmesi.
Kullanıcının arkadaşlarının profil sayfasında gösterilmesi.
Kullanıcının en son yazdığı blog içeriklerinin profil sayfasında gösterilmesi.
Kullanıcının doğru bir şekilde giriş yaptığını doğrulamak için Firebase Authentication servisi ile mevcuttaki kullanıcı bilgileri ile authentication olmuş kullanıcı bilgileri karşılaştırarak kontrol edilir. Ardından kullanıcının isim, email ve fotoğrafları profile eklenir. Ardından Firebase Realtime Database’ e erişilerek kullanıcının en son yazdığı 3 blog içeriğini ve arkadaşlarını çekerek profil sayfasına eklenir ve son hali verilir.

Kullanıcının Blog yazıları paylaşması ve görüntülemesi:

figür 41:  blog yazıları görüntüleme akış diyagramı

Kullanıcı sisteme giriş yaptıktan sonra Blog sekmesinde daha önceden sisteme kayıtlı kullanıcılar tarafından yazılmış olan blog içeriklerini görebilmesi gerekmektedir. 
Firebase Realtime Database içerisinde saklanan blog içeriklerinin çekilmesi.
Firebase Realtime Database’e erişilerek blog içerikleri yazarı dikkate alınmaksızın hepsi çekilir ve blog sayfasına yazarı, başlığı, içeriği ve tarihi şeklinde ayırarak yazılır.



Kullanıcı Giriş Yapma Bileşeni:

figür 42: kullanıcı giriş yapma akış diyagramı

Kullanıcı sisteme giriş yaptığında daha önceden sisteme kayıtlı kimlik bilgilerini, Facebook hesabını ve Google hesabını kullanarak sisteme giriş yapması gerekmektedir. Kullanıcı bu iç seçenekten herhangi biri ile hesabının authentication işlemi ile gerçekleştirmelidir. Bu işlem için Firebase Authentication service kullanılır ve tanımlı metodlar ile üç seçenek de kullanılabilir hale gelmektedir.

Vakıflar Modülü

Vakıf Bültenlerinin Çekilmesi:
Kullanıcıların karbon ayak izlerini nasıl azaltabileceklerini öğrenmeleri ve doğamızı korumak adına yapılan çalışmalardan haberdar olmaları uygulamamızın gerçekleştirmesi gereken bir özelliktir. Bu hedefi gerçekleştirmek için aşağıdaki gereksinimlerin karşılanması gerekmektedir.
Firebase Real Database bağlantısının kurulması
Jsoup kütüphanesi kullanılarak vakıfların sitelerinden bültenlerinin çekilmesi
Çekilen haberlerin Firebase Real Database’e yazılması.
Web scraping kodları Tema ve Greenpeace için ayrı sınıflarda yazılmıştır. Verileri çekme aşamasında Jsoup kütüphanesini kullandığımız için HTML taglerinin siteden siteye farklılık göstermesinden ötürü iki farklı sınıf için ayrı kod yazılmıştır. MainActivity içinden çağrılmakta ve çekilen veriler Firebase’e yazılmaktadır. Sequence diagramı aşağıda gösterilmiştir.


figür 43: vakıf haberlerinin gösterilmesi akış diyagramı

Vakıflar Sayfalarının Gösterilmesi:
Kayıtlı olan vakıfların bir liste halinde gösterilmesi ve listeden seçilen vakfın sayfasına gidilmesi sağlanmalıdır. Main activity’e eklenmiş bottom navigation bar aracılığıyla kullanıcı aşağıdaki diagramda “Foundation Fragment” olarak belirtilmiş, bu listelemenin olduğu sayfaya gidebilmektedir. Bu sayfanın içinde RecyclerView şeklinde tutulan listeden istediği vakfa tıklayarak FoundationItemAdapter aracılığıyla vakfın sayfasına gider. Vakfın sayfasında fotoğrafı, açıklaması, bağış butonu, toplam bağış miktarı ve bülteni gösterilmektedir. Bu veriler Firebase’den çekerek güncel olarak kullanıcılara gösterilir.

figür 44: vakıf sayfaları gösterimi akış diyagramı

Vakıflara Bağış Yapılması ve Veri tabanının Güncellenmesi:
Vakıf sayfalarının içinde bağış butonu tanımlanmıştır. Aşağıdaki diagramda Donation Button olarak gösterilmektedir. Kullanıcı butona tıkladığında DonationDialog açılır. Kullanıcıdan bağış yapmak istediği miktar alınır. Alınan miktar Firabase’de ilgili vakfın bağış miktarına eklenir ve kullanıcının yaptığı bağış miktarının 1/10 kadarı kullanıcının karbon ayak izinden düşülerek veri tabanına yazılır. Bu işlemlerin sonunda kullanıcıya tebrik mesajı gösterilir. 



figür 45: bağış yapma akış diyagramı
Keşfet Modülü
Android uygulamasında bulunan home sayfasında karbon ayakizine göre sıralanmış lider tablosu bulunmaktadır. Bu tablosunun oluşturuluşu ve sergilenişi aşağıdaki akış diyagramında gösterilmiştir. HomeFragment sayfasında lider tablosu butonu oluşturulur. Butona tıklanıldığı zaman buton kendi metodu içerisinde tabloyu popup şeklinde oluşturmaya başlar. FirebaseRecyclerOptions objesi ile veritabanına kullanıcıları toplam karbon ayakizlerine göre sıralayan bir sorgu gönderir. Bu sorgu sonuçları FirebaseRecyclerAdapter ile ilişkilendirilir. Adapter sayesinde Android üzerinde sergilenecek olan View ve bu view üzerine yazılacak veriler oluşturulur. Daha sonra popup kullanıcıya gösterilir.

figür 46: lider tablosu görüntüleme akış diyagramı

Keşfet panosunda listelenecek olan verilerin veritabanından okunması ve bir View üzerinde okunan verilerin CardView olarak sergilenmesi gerekmektedir. Bu eylemlerin gerçekleştirilmesi aşağıda bulunan akış diyagramında gösterilmektedir. Dashboard fragment readData metodu ile Firebase veritabanıyla iletişim kurar ve veritabanından kullanıcıların blog yazıları ile vakıfların paylaştığı haberleri alır. Bu haberler bir adapter objesi ile kullanıcıya aktarılabilecek hale getirilir. 
Filtreleme işlemi için Dashboard Fragment bir QueryTextListener objesi olarak tanımlanmıştır ve paylaşımlar gösterildikten sonra filtreleme işlemi için hazır konuma geçer. Filtreleme işlemi için girilen query string Adapter objesine aktarılır ve filtreleme sonucu yeni bir View oluşturularak kullanıcıya aktarılır.

figür 47: keşfet gönderilerinin gösterilmesi ve filtrelenmesi akış diyagramı

Geri Dönüşüm Modülü

Geri Dönüşüm Noktalarının Harita Üzerinde Gösterilmesi (Web):
Kullanıcı geri dönüşüm sekmesine tıkladığında geri dönüşümün önemini anlatan bir görsel açılır ve geri dönüşüm noktalarını gösterme butonu gösterilir. Geri dönüşüm noktasına tıklandığında Google Maps ekranı açılır ve kullanıcının konum bilgileri için izin istenir. Eğer kullanıcı izin vermezse izin vermesi gerektiği uyarı olarak gösterilir. Kullanıcının alınan konumu daha sonra yol tarifi yapılırken kullanılacaktır.

figür 48: geri dönüşüm noktaları gösterimi akış diyagramı

Kullanıcının istediği geri dönüşüm noktasına yol tarifi alması ve işlem tamamlandığında karbon ayakizinin azaltılması (Web):
Bu modülden önceki modül, öncelikle kullanıcıya bir harita arayüzü sunar. Bunu yapmak için GoogleMaps API yardımıyla harita oluşturulur. Harita üzerinde önceden bilinen geri dönüşüm noktalarının işaretlenmesi için initMap() yardımı ile kml noktaları harita üzerinde set edilir. Bu kml noktaları Çankaya Belediyesi’nden alınmıştır. Böylece geri dönüşüm noktaları belirlenir. 
Kullanıcı bir geri dönüşüm noktası seçimi yaptığında bu bilgiler kullanıcının şu andaki konumu ile geri dönüşüm noktası arasında rota belirlenir. Bu modül ise, kullanıcı geri dönüşümünü tamamladığını belirttiğinde kullanıcının Karbon ayak izini Firebase üzerinden günceller.


figür 49: yol tarifi alma akış diyagramı
